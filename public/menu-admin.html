<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì•„ì¦ˆë‹ˆì„¬ ë©”ë‰´ ê´€ë¦¬</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            max-width: 1200px; 
            margin: 0 auto; 
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 { color: #333; text-align: center; }
        .auth-section {
            margin-bottom: 30px;
            padding: 20px;
            background-color: #f8f9fa;
            border-radius: 5px;
        }
        .menu-section {
            margin-bottom: 30px;
        }
        .menu-item {
            display: flex;
            align-items: center;
            padding: 10px;
            margin: 5px 0;
            background-color: #f8f9fa;
            border-radius: 5px;
            border: 1px solid #e9ecef;
        }
        .menu-item input[type="text"] {
            margin: 0 10px;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            flex: 1;
        }
        .menu-item select {
            margin: 0 10px;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        button {
            padding: 10px 20px;
            margin: 5px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        .btn-primary { background-color: #007bff; color: white; }
        .btn-success { background-color: #28a745; color: white; }
        .btn-danger { background-color: #dc3545; color: white; }
        .btn-secondary { background-color: #6c757d; color: white; }
        .options-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
        .option-group {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 5px;
        }
        .option-item {
            display: flex;
            align-items: center;
            margin: 10px 0;
        }
        .option-item input {
            margin-right: 10px;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            flex: 1;
        }
        #authStatus {
            color: #28a745;
            font-weight: bold;
        }
        .hidden { display: none; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸï¸ ì•„ì¦ˆë‹ˆì„¬ ë©”ë‰´ ê´€ë¦¬</h1>
        
        <div class="auth-section">
            <h3>ì¸ì¦</h3>
            <input type="password" id="password" placeholder="ê´€ë¦¬ì ë¹„ë°€ë²ˆí˜¸" style="padding: 10px; margin-right: 10px; border: 1px solid #ddd; border-radius: 4px;">
            <button onclick="authenticate()" class="btn-primary">ë¡œê·¸ì¸</button>
            <div id="authStatus" class="hidden">âœ… ì¸ì¦ë¨</div>
        </div>

        <div id="menuManager" class="hidden">
            <div class="menu-section">
                <h3>ë©”ë‰´ ëª©ë¡</h3>
                <div style="margin-bottom: 15px; padding: 15px; background-color: #e3f2fd; border-radius: 5px; border-left: 4px solid #2196f3;">
                    <div style="color: #666; font-size: 14px; margin-bottom: 10px;">
                        <strong>í‘œì‹œëª…:</strong> ì‚¬ìš©ìì—ê²Œ ë³´ì—¬ì§€ëŠ” ì´ë¦„ | <strong>ì½”ë“œê°’:</strong> ì‹œìŠ¤í…œì—ì„œ ì‚¬ìš©í•˜ëŠ” ê°’
                    </div>
                    <div style="color: #333; font-size: 13px;">
                        <strong>ì¹´í…Œê³ ë¦¬ë³„ ì˜µì…˜:</strong><br>
                        â€¢ <strong>ì»¤í”¼:</strong> ì›ë‘ ì˜µì…˜, ì˜¨ë„ ì˜µì…˜, ì¶”ê°€ ì˜µì…˜ ëª¨ë‘ ì„ íƒ ê°€ëŠ¥ (ì˜ˆ: ì•„ë©”ë¦¬ì¹´ë…¸, ì¹´í˜ë¼ë–¼)<br>
                        â€¢ <strong>ì°¨:</strong> ì˜¨ë„ ì˜µì…˜, ì¶”ê°€ ì˜µì…˜ ì„ íƒ ê°€ëŠ¥ (ì˜ˆ: ë ˆëª¬ì°¨, í˜¸ì§€ì°¨)<br>
                        â€¢ <strong>ìŒë£Œ:</strong> ì˜¨ë„ ì˜µì…˜, ì¶”ê°€ ì˜µì…˜ ì„ íƒ ê°€ëŠ¥ (ì˜ˆ: ë ˆëª¬ì—ì´ë“œ, ìëª½ì—ì´ë“œ)<br>
                        â€¢ <strong>ë³‘ìŒë£Œ:</strong> ì¶”ê°€ ì˜µì…˜ë§Œ ì„ íƒ ê°€ëŠ¥ (ì˜ˆ: ë¶„ë‹¤ë²„ê·¸ ì§„ì €ë¹„ì–´)
                    </div>
                </div>
                <div id="menuList"></div>
                <button onclick="addMenuItem()" class="btn-success">+ ë©”ë‰´ ì¶”ê°€</button>
            </div>

            <div class="options-section">
                <div class="option-group">
                    <h4>ì›ë‘ ì˜µì…˜ (ì½ê¸° ì „ìš©)</h4>
                    <div style="font-size: 12px; color: #666; margin-bottom: 10px;">ì»¤í”¼ ì¹´í…Œê³ ë¦¬ ë©”ë‰´ì—ë§Œ ì ìš©ë©ë‹ˆë‹¤</div>
                    <div id="beanOptions"></div>
                </div>

                <div class="option-group">
                    <h4>ì˜¨ë„ ì˜µì…˜ (ì½ê¸° ì „ìš©)</h4>
                    <div style="font-size: 12px; color: #666; margin-bottom: 10px;">ë³‘ìŒë£Œë¥¼ ì œì™¸í•œ ëª¨ë“  ì¹´í…Œê³ ë¦¬ì— ì ìš©ë©ë‹ˆë‹¤</div>
                    <div id="temperatureOptions"></div>
                </div>

                <div class="option-group">
                    <h4>ì¶”ê°€ ì˜µì…˜ (ì½ê¸° ì „ìš©)</h4>
                    <div style="font-size: 12px; color: #666; margin-bottom: 10px;">ëª¨ë“  ë©”ë‰´ì— ì ìš©ë©ë‹ˆë‹¤</div>
                    <div id="extraOptions"></div>
                </div>
            </div>

            <div style="text-align: center; margin-top: 30px;">
                <button onclick="saveMenu()" class="btn-primary" style="font-size: 18px; padding: 15px 30px;">ğŸ’¾ ë©”ë‰´ ì €ì¥</button>
            </div>
        </div>
    </div>

    <script>
        let menuData = {{MENU_DATA}};
        let isAuthenticated = false;

        function authenticate() {
            const password = document.getElementById('password').value;
            if (password === 'asnisum2025') {
                isAuthenticated = true;
                document.getElementById('authStatus').classList.remove('hidden');
                document.getElementById('menuManager').classList.remove('hidden');
                loadMenuData();
            } else {
                alert('ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë ¸ìŠµë‹ˆë‹¤.');
            }
        }

        function loadMenuData() {
            renderMenuList();
            renderOptions();
        }

        function renderMenuList() {
            const container = document.getElementById('menuList');
            container.innerHTML = '';
            
            menuData.menus.forEach((menu, index) => {
                const div = document.createElement('div');
                div.className = 'menu-item';
                div.innerHTML = `
                    <input type="text" value="${menu.text}" onchange="updateMenu(${index}, 'text', this.value)" placeholder="í‘œì‹œëª… (ì˜ˆ: ì•„ë©”ë¦¬ì¹´ë…¸)" style="flex: 1; margin-right: 5px;">
                    <input type="text" value="${menu.value}" onchange="updateMenu(${index}, 'value', this.value)" placeholder="ì½”ë“œê°’ (ì˜ˆ: americano)" style="flex: 1; margin-right: 5px;">
                    <select onchange="updateMenu(${index}, 'category', this.value)" style="margin-right: 5px;">
                        <option value="coffee" ${menu.category === 'coffee' ? 'selected' : ''}>ì»¤í”¼ (ëª¨ë“  ì˜µì…˜ ì„ íƒ ê°€ëŠ¥)</option>
                        <option value="tea" ${menu.category === 'tea' ? 'selected' : ''}>ì°¨ (ì˜¨ë„/ì¶”ê°€ ì˜µì…˜ ì„ íƒ ê°€ëŠ¥)</option>
                        <option value="ade" ${menu.category === 'ade' ? 'selected' : ''}>ìŒë£Œ (ì˜¨ë„/ì¶”ê°€ ì˜µì…˜ ì„ íƒ ê°€ëŠ¥)</option>
                        <option value="bottle" ${menu.category === 'bottle' ? 'selected' : ''}>ë³‘ìŒë£Œ (ì¶”ê°€ ì˜µì…˜ë§Œ)</option>
                    </select>
                    <button onclick="removeMenu(${index})" class="btn-danger">ì‚­ì œ</button>
                `;
                container.appendChild(div);
            });
        }

        function renderOptions() {
            renderOptionList('beanOptions', menuData.beanOptions);
            renderOptionList('temperatureOptions', menuData.temperatureOptions);
            renderOptionList('extraOptions', menuData.extraOptions);
        }

        function renderOptionList(containerId, options) {
            const container = document.getElementById(containerId);
            container.innerHTML = '';
            
            options.forEach((option, index) => {
                const div = document.createElement('div');
                div.className = 'option-item';
                div.innerHTML = `
                    <span style="flex: 1; padding: 8px; background-color: #f8f9fa; border-radius: 4px; margin-right: 5px;">${option.text}</span>
                    <span style="flex: 1; padding: 8px; background-color: #f8f9fa; border-radius: 4px; color: #666; font-family: monospace;">${option.value}</span>
                `;
                container.appendChild(div);
            });
        }

        function updateMenu(index, field, value) {
            menuData.menus[index][field] = value;
        }

        function addMenuItem() {
            const menuNum = menuData.menus.length + 1;
            menuData.menus.push({
                text: 'ìƒˆ ë©”ë‰´' + menuNum,
                value: 'new_menu_' + menuNum,
                category: 'coffee'
            });
            renderMenuList();
        }

        function removeMenu(index) {
            menuData.menus.splice(index, 1);
            renderMenuList();
        }


        async function saveMenu() {
            if (!isAuthenticated) {
                alert('ì¸ì¦ì´ í•„ìš”í•©ë‹ˆë‹¤.');
                return;
            }

            if (!confirm('ë©”ë‰´ë¥¼ ì €ì¥í•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì´ ì‘ì—…ì€ GitHubì— ì»¤ë°‹ë©ë‹ˆë‹¤.')) {
                return;
            }

            try {
                const response = await fetch('/api/menu-admin', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        action: 'save',
                        menuData: menuData,
                        password: document.getElementById('password').value
                    })
                });

                const result = await response.json();
                
                if (response.ok) {
                    alert('ë©”ë‰´ê°€ ì„±ê³µì ìœ¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!');
                } else {
                    alert('ì €ì¥ ì‹¤íŒ¨: ' + result.error);
                }
            } catch (error) {
                alert('ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
            }
        }
    </script>
</body>
</html>